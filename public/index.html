<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>PGA Golf Challenge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="css/bootstrap-responsive.css">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="container-fluid">

  <script type="text/x-handlebars" data-template-name="application">
    <div class="navbar navbar-static-top">
      <div class="navbar-inner">
        <a class="brand" href="#">PGA Golf Challenge</a>
        <ul class="nav">
          <li><a href="#/brackets/1">Bracket</a></li>
          <li><a href="#/achievements">Achievements</a></li>
        </ul>
      </div>
    </div>

    <div class="row-fluid">
      <div class="span2 hidden-phone"></div>
      <div class="span12 main">
        {{outlet}}
      </div>
      <div class="span2 hidden-phone"></div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="achievements/index">
    <h3>Achievements</h3>
    <table class="table">
      <tbody>
      {{#each achievement in model}}
        <tr>
          <th class="text-center">
            <h4>{{achievement.points}}</h4>
          </th>
          <td>
            <strong>{{translate achievement.key}}</strong><br/>
            <em>Awarded {{pluralize achievement.golferAchievements.length 'time'}} to {{achievement.golfers.length}} golfers.</em>
          </td>
          <td>
            <button class="btn btn-info pull-right" {{action "awardAchievement" achievement}}>
              <i class="icon-star icon-white"></i> Award
            </button>
          </td>
        </tr>
      {{/each}}
      </tbody>
    </table>
  </script>

  <script type="text/x-handlebars" data-template-name="achievements/award">
    <h3>Award Achievement</h3>
    <p class="text-center">{{translate achievement.key}}</p>
    {{#if controller.golfers.isLoaded}}
    <div class="row-fluid">
      <div class="span12">
      {{select contentBinding="controller.golfers"
               selectionBinding="controller.selectedGolfer"
               optionValuePath="content.id"
               optionLabelPath="content.name"}}
      </div>
    </div>
    <div class="row-fluid">
      <div class="span12">
      <button class="btn btn-info" {{action "award"}}>
        <i class="icon-star icon-white"></i> Award Achievement
      </button>
      <a class="btn" href="#/achievements">Cancel</a>
      </div>
    </div>
    {{else}}
      Loading Golfers...
    {{/if}}
  </script>

  <script type="text/x-handlebars" data-template-name="brackets/show">
    <h3>Your Bracket</h3>
    {{#linkTo brackets.edit model class="btn btn-primary top-action top-action-right"}}
      <i class="icon-edit icon-white"></i> Edit
    {{/linkTo}}
    <table class="table">
      <thead>
        <tr>
          <th class="text-center">Rank</th>
          <th class="text-left">Golfer</th>
          <th class="text-right">Achievements</th>
          <th class="text-right">Score</th>
        </tr>
      </thead>
      <tbody>
        {{#each golfer in bracket.golfers}}
          <tr>
            <td class="text-center" style="position:relative;">
              <strong style="text-shadow:0px 0px 8px white;">{{golfer.rank}}</strong>
              <div style="position:absolute;top:0;left:0;right:0;bottom:0;">
                {{flag countryBinding="golfer.country"}}
              </div>
            </td>
            <td colspan="2">
              <strong>{{golfer.name}}</strong><br/>
              {{golfer.country.name}}
            </td>
            <th class="text-right">{{golfer.score}}</th>
          </tr>
          {{#each golferAchievement in golfer.golferAchievements}}
          <tr class="child">
            <td colspan="3" class="text-right">
              {{translate golferAchievement.key}}
            </td>
            <td class="text-right">{{golferAchievement.points}}</td>
          </tr>
          {{/each}}
        {{/each}}
      </tbody>
      <tfoot>
        <tr>
          <th colspan="3" class="text-right">
            Total Score:
          </th>
          <th class="text-right">{{bracket.score}}</th>
        </tr>
      </tfoot>
    </table>
  </script>

  <script type="text/x-handlebars" data-template-name="brackets/edit">
    {{#if bracket.isLoaded}}
    <h3>Edit Your Bracket</h3>
    {{#linkTo brackets.show model class="btn btn-primary top-action top-action-right"}}
      Done
    {{/linkTo}}

    <div class="progress big">
      <div class="bar bar-info" {{bindAttr style="controller.spentBarStyle"}}>
        {{bracket.spent}} Points Spent
      </div>
      <div class="bar bar-success" {{bindAttr style="controller.availableBarStyle"}}>
        {{bracket.pointsAvailable}} Points Available
      </div>
    </div>

    <h4>Selected Golfers <small>({{bracket.bracketGolfers.length}})</small></h4>

    {{#if bracket.bracketGolfers.isEmpty}}
      <p><em>Select from the available golfers below to build your bracket.</em></p>
    {{/if}}

    <table class="table table-striped">
      <tbody>
      {{#each bracketGolfer in bracket.bracketGolfers}}
        {{#with bracketGolfer}}
        <tr>
          <td class="text-center" style="position:relative;">
            <strong style="text-shadow:0px 0px 8px white;">{{golfer.rank}}</strong>
            <div style="position:absolute;top:0;left:0;right:0;bottom:0;">
              {{flag countryBinding="golfer.country"}}
            </div>
          </td>
          <td>
            <strong>{{golfer.name}}</strong><br/>
            <small>{{golfer.country.name}}</small><br/>
            <em>{{golfer.cost}} points</em>
          </td>
          <td>
            <button class="btn btn-danger pull-right" {{action "removeGolfer" bracketGolfer}}>
              <i class="icon-minus icon-white"></i> Remove
            </button>
          </td>
          {{/with}}
        </tr>
      {{/each}}
      </tbody>
    </table>

    <hr>

      {{#unless controller.availableGolfers.isEmpty}}
      <h4>Available Golfers <small>({{controller.availableGolfers.length}})</small></h4>
      {{input type="text" class="span12" placeholder="Search by name" valueBinding="controller.availableGolferFilter"}}
      <table class="table table-striped">
        <tbody>
      {{#each golfer in controller.availableGolfers}}
        <tr>
          <td class="text-center" style="position:relative;">
            <strong style="text-shadow:0px 0px 8px white;">{{golfer.rank}}</strong>
            <div style="position:absolute;top:0;left:0;right:0;bottom:0;">
              {{flag countryBinding="golfer.country"}}
            </div>
          </td>
          <td>
            <strong>{{golfer.name}}</strong><br/>
            <small>{{golfer.country.name}}</small><br/>
            <em>{{golfer.cost}} points</em>
          </td>
          <td>
            <button class="btn btn-success pull-right" {{action "addGolfer" golfer}}>
              <i class="icon-plus icon-white"></i> Add
            </button>
          </td>
        </tr>
      {{/each}}
        </tbody>
      </table>
      {{/unless}}
    {{else}}
      <p class="text-center text-info"><em>Loading bracket...</em></p>
    {{/if}}
  </script>

  <script src="js/libs/jquery-1.9.1.js"></script>
  <script src="js/libs/handlebars-1.0.0-rc.4.js"></script>
  <script src="js/libs/ember-1.0.0-rc.6.js"></script>
  <script src="js/libs/ember-data.js"></script>
  <script src="js/app.js"></script>
  <script src="js/translations.js"></script>
  <script src="js/helpers/translate.js"></script>
  <script src="js/helpers/select_field_helper.js"></script>
  <script src="js/helpers/pluralize.js"></script>
  <script src="js/models/achievement.js"></script>
  <script src="js/models/bracket.js"></script>
  <script src="js/models/golfer.js"></script>
  <script src="js/models/golfer_achievement.js"></script>
  <script src="js/models/bracket_golfer.js"></script>
  <script src="js/models/country.js"></script>
  <script src="js/controllers/achievements_index_controller.js"></script>
  <script src="js/controllers/achievements_award_controller.js"></script>
  <script src="js/controllers/brackets_edit_controller.js"></script>
  <script src="js/routes/index_route.js"></script>
  <script src="js/routes/achievements_index_route.js"></script>
  <script src="js/routes/achievements_award_route.js"></script>
  <script src="js/routes/brackets_edit_route.js"></script>
  <script src="js/routes/brackets_show_route.js"></script>
  <script src="js/views/flag_view.js"></script>

</body>
</html>
